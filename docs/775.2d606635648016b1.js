"use strict";(self.webpackChunkangular_movie_app=self.webpackChunkangular_movie_app||[]).push([[775],{775:(K,m,s)=>{s.r(m),s.d(m,{ListV2Component:()=>B});var v=s(6814),t=s(5879),u=s(3403),O=s(1993),d=s(2096),h=s(9397),g=s(5177),f=s(6328),L=s(3522),p=s(5525),D=s(5508),C=s(3758),W=s(5662),A=s(4292),P=s(18);function T(_,S){1&_&&t._UZ(0,"app-skeleton-loader")}function I(_,S){if(1&_){const e=t.EpF();t._UZ(0,"app-movie-slider",2),t.TgZ(1,"app-movie-carousel",3),t.NdJ("sortByAction",function(n){t.CHM(e);const i=t.oxw();return t.KtG(i.requestSortBy(n))})("watchListAction",function(n){t.CHM(e);const i=t.oxw();return t.KtG(i.requestModifyWatchList(n))})("selected",function(n){t.CHM(e);const i=t.oxw();return t.KtG(i.selectMovie(n))}),t.qZA()}if(2&_){const e=t.oxw();t.Q6J("movies",e.movies()),t.xp6(1),t.Q6J("movies",e.movies())}}let B=(()=>{class _{constructor(e,o,n){this.injector=e,this.movieApiService=o,this.movieStoreV2=n,this.destroyRef=(0,t.f3M)(t.ktI),this.isLoading=(0,t.Flj)(()=>this.movieStoreV2.isLoading()),this.watchList=(0,t.Flj)(()=>{const i=this.movieStoreV2.watchList();return Array.from(i.values())}),this.movies=(0,t.Flj)(()=>{const i=this.movieStoreV2.movies(),c=this.movieStoreV2.sortBy(),V=this.watchList(),E=i.map(a=>{const l=V.some(r=>r.title===a.title);return{...a,isWatchList:l}});return c?E.slice().sort((a,l)=>{const r=a[c]??"",M=l[c]??"";return r<M?-1:r>M?1:0}):E})}ngOnInit(){this.getMovies(),this.getWatchList(),this.initEffects()}requestSortBy(e){this.movieStoreV2.setSortBy(e)}requestModifyWatchList(e){this.watchList().some(o=>o.title===e.title)?this.movieStoreV2.removeToWatchList(e):this.movieStoreV2.addToWatchList({...e,isWatchList:!0})}selectMovie(e){this.movieStoreV2.setSelectedMovie(e)}initEffects(){(0,t.cEC)(()=>{this.setWatchListOnLocalStorage(this.watchList())},{injector:this.injector})}getWatchList(){this.movieStoreV2.setWatchList(this.getWatchListOnLocalStorage())}getMovies(){(0,d.of)(null).pipe((0,h.b)(()=>this.movieStoreV2.setLoading(!0)),(0,g.g)(2e3),(0,f.b)(()=>this.movieApiService.getMovies()),(0,h.b)(e=>{this.movieStoreV2.setMovies(e),this.movieStoreV2.setLoading(!1)}),(0,O.sL)(this.destroyRef)).subscribe()}getWatchListOnLocalStorage(){return p._.getItem(L.F.MOVIE_WATCH_LIST)||[]}setWatchListOnLocalStorage(e){return p._.setItem(L.F.MOVIE_WATCH_LIST,e)}static#t=this.\u0275fac=function(o){return new(o||_)(t.Y36(t.zs3),t.Y36(A.$),t.Y36(P.h))};static#e=this.\u0275cmp=t.Xpm({type:_,selectors:[["app-list-v2"]],standalone:!0,features:[t.jDz],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["content",""],[3,"movies"],[3,"movies","sortByAction","watchListAction","selected"]],template:function(o,n){if(1&o&&(t.YNc(0,T,1,0,"app-skeleton-loader",0),t.YNc(1,I,2,2,"ng-template",null,1,t.W1O)),2&o){const i=t.MAs(2);t.Q6J("ngIf",n.isLoading())("ngIfElse",i)}},dependencies:[v.ez,v.O5,u.Bz,D.A,C.t,W.Q],changeDetection:0})}return _})()}}]);