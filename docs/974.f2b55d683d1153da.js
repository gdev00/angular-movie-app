"use strict";(self.webpackChunkangular_movie_app=self.webpackChunkangular_movie_app||[]).push([[974],{8974:(ot,y,o)=>{o.r(y),o.d(y,{ListV1Component:()=>it});var t=o(5879),C=o(2096),r=o(9397),W=o(5177),U=o(4664),L=o(8180),p=o(7398),T=o(3522),v=o(1993),S=o(5525),Z=o(4292),f=o(5619);let w=(()=>{class s{constructor(){this._movieSelected$=new f.X(void 0),this._movies$=new f.X([]),this._watchList$=new f.X(new Map),this._isLoading$=new f.X(!0),this.movieSelected$=this._movieSelected$.asObservable(),this.movies$=this._movies$.asObservable(),this.watchList$=this._watchList$.asObservable().pipe((0,p.U)(e=>Array.from(e.values()))),this.isLoading$=this._isLoading$.asObservable()}setLoading(e){this._isLoading$.next(e)}setSelectedMovie(e){this._movieSelected$.next(e)}setMovies(e){this._movies$.next(e)}setWatchList(e){this._watchList$.next(new Map(e.map(i=>[i.title,i])))}addToWatchList(e){const i=this._watchList$.getValue();i.set(e.title,e),this._watchList$.next(i)}removeToWatchList(e){const i=this._watchList$.getValue();i.delete(e.title),this._watchList$.next(i)}static#t=this.\u0275fac=function(i){return new(i||s)};static#e=this.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})(),_=(()=>{class s{constructor(e,i){this.movieApiService=e,this.moveStoreV1=i,this.destroyRef=(0,t.f3M)(t.ktI),this.movieSelected$=this.moveStoreV1.movieSelected$,this.movies$=this.moveStoreV1.movies$,this.watchList$=this.moveStoreV1.watchList$,this.isLoading$=this.moveStoreV1.isLoading$}getWatchListOnLocalStorage(){return S._.getItem(T.F.MOVIE_WATCH_LIST)||[]}setWatchListOnLocalStorage(e){return S._.setItem(T.F.MOVIE_WATCH_LIST,e)}getMovies(){(0,C.of)(null).pipe((0,r.b)(()=>this.moveStoreV1.setLoading(!0)),(0,W.g)(2e3),(0,U.w)(()=>this.movieApiService.getMovies()),(0,r.b)(e=>this.moveStoreV1.setMovies(e)),(0,r.b)(()=>this.moveStoreV1.setLoading(!1)),(0,v.sL)(this.destroyRef)).subscribe()}getMovie(e){this.movieApiService.getMovie(e).pipe((0,r.b)(i=>this.moveStoreV1.setSelectedMovie(i)),(0,v.sL)(this.destroyRef)).subscribe()}getWatchList(){this.moveStoreV1.setWatchList(this.getWatchListOnLocalStorage())}sortMovies(e){this.movies$.pipe((0,L.q)(1),(0,p.U)(i=>i.slice().sort((n,l)=>{const c=n[e]??"",h=l[e]??"";return c<h?-1:c>h?1:0})),(0,r.b)(i=>this.moveStoreV1.setMovies(i)),(0,v.sL)(this.destroyRef)).subscribe()}modifyWatchList(e){this.watchList$.pipe((0,L.q)(1),(0,r.b)(i=>{i.some(n=>n.title===e.title)?this.moveStoreV1.removeToWatchList(e):this.moveStoreV1.addToWatchList(e)}),(0,v.sL)(this.destroyRef)).subscribe()}selectMovie(e){this.moveStoreV1.setSelectedMovie(e)}static#t=this.\u0275fac=function(i){return new(i||s)(t.LFG(Z.$),t.LFG(w))};static#e=this.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac})}return s})();var R=o(836),V=o(8645),F=o(4552);class D extends V.x{constructor(a=1/0,e=1/0,i=F.l){super(),this._bufferSize=a,this._windowTime=e,this._timestampProvider=i,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=e===1/0,this._bufferSize=Math.max(1,a),this._windowTime=Math.max(1,e)}next(a){const{isStopped:e,_buffer:i,_infiniteTimeWindow:n,_timestampProvider:l,_windowTime:c}=this;e||(i.push(a),!n&&i.push(l.now()+c)),this._trimBuffer(),super.next(a)}_subscribe(a){this._throwIfClosed(),this._trimBuffer();const e=this._innerSubscribe(a),{_infiniteTimeWindow:i,_buffer:n}=this,l=n.slice();for(let c=0;c<l.length&&!a.closed;c+=i?1:2)a.next(l[c]);return this._checkFinalizedStatuses(a),e}_trimBuffer(){const{_bufferSize:a,_timestampProvider:e,_buffer:i,_infiniteTimeWindow:n}=this,l=(n?1:2)*a;if(a<1/0&&l<i.length&&i.splice(0,i.length-l),!n){const c=e.now();let h=0;for(let m=1;m<i.length&&i[m]<=c;m+=2)h=m;h&&i.splice(0,h+1)}}}var Y=o(3020),x=o(2572),A=o(2181),Q=o(4716),u=o(6814),g=o(3403),z=o(3758),q=o(5508),J=o(5662),d=o(696),I=o(2296),$=o(617),B=o(3785),b=o(3259),N=o(6593);function j(s,a){1&s&&(t.TgZ(0,"mat-icon"),t._uU(1,"check"),t.qZA())}function P(s,a){1&s&&(t.TgZ(0,"mat-icon"),t._uU(1,"add"),t.qZA())}function E(s,a){if(1&s&&(t.TgZ(0,"p")(1,"span",22),t._uU(2),t.qZA(),t.TgZ(3,"span",23),t._uU(4),t.qZA()()),2&s){const e=a.ngIf;t.xp6(2),t.hij("",null==e?null:e[0]," / "),t.xp6(2),t.Oqu(null==e?null:e[1])}}function H(s,a){1&s&&t._UZ(0,"iframe",24),2&s&&t.Q6J("src",a.ngIf,t.uOi)}function G(s,a){if(1&s){const e=t.EpF();t.ynx(0),t.TgZ(1,"section",6)(2,"div",7)(3,"div",8)(4,"div",9)(5,"h1",10),t._uU(6),t.qZA(),t.TgZ(7,"button",11),t.NdJ("click",function(){const l=t.CHM(e).ngIf,c=t.oxw();return t.KtG(c.requestUpdateWatchList(l))}),t.YNc(8,j,2,0,"mat-icon",12),t.YNc(9,P,2,0,"mat-icon",12),t.qZA()(),t.TgZ(10,"p",13),t._uU(11),t.qZA(),t.TgZ(12,"div",14)(13,"div",15)(14,"p",16),t._uU(15,"Rating:"),t.qZA(),t.TgZ(16,"div",17)(17,"mat-icon",18),t._uU(18,"star"),t.qZA(),t.YNc(19,E,5,2,"p",12),t.qZA()(),t.TgZ(20,"div",15)(21,"p",16),t._uU(22,"Duration:"),t.qZA(),t.TgZ(23,"p",19),t._uU(24),t.qZA()(),t.TgZ(25,"div",15)(26,"p",16),t._uU(27,"Genre:"),t.qZA(),t.TgZ(28,"p",19),t._uU(29),t.qZA()(),t.TgZ(30,"div",15)(31,"p",16),t._uU(32,"Release Date:"),t.qZA(),t.TgZ(33,"p",19),t._uU(34),t.qZA()(),t.TgZ(35,"div",15)(36,"p",16),t._uU(37,"Review:"),t.qZA(),t.TgZ(38,"p",19),t._uU(39),t.qZA()()(),t._UZ(40,"div",20),t.qZA()(),t.TgZ(41,"div",7)(42,"div",8),t.YNc(43,H,1,1,"iframe",21),t.qZA()()(),t.BQk()}if(2&s){const e=a.ngIf,i=t.oxw();t.xp6(6),t.hij(" ",e.title," "),t.xp6(1),t.Q6J("pTooltip",e.isWatchList?"Remove from watch list":"Add to watch list"),t.xp6(1),t.Q6J("ngIf",null==e?null:e.isWatchList),t.xp6(1),t.Q6J("ngIf",!(null!=e&&e.isWatchList)),t.xp6(2),t.hij(" ",e.description," "),t.xp6(8),t.Q6J("ngIf",null==e.rate?null:e.rate.split("/")),t.xp6(5),t.Oqu(e.duration),t.xp6(5),t.Oqu(e.genre),t.xp6(5),t.Oqu(e.releaseDate),t.xp6(5),t.Oqu(e.review),t.xp6(4),t.Q6J("ngIf",i.movieTrailerSrc)}}function X(s,a){1&s&&(t.TgZ(0,"p"),t._uU(1,"No Data"),t.qZA())}let K=(()=>{class s{constructor(e,i,n,l){this.dialogRef=e,this.data=i,this.sanitizer=n,this.router=l,this.watchListAction=new t.vpe}get movieTrailerSrc(){return this.sanitizer.bypassSecurityTrustResourceUrl(B.v.convertYoutubeLinkToEmbededURL(this.data.movie?.trailerLink))}requestUpdateWatchList(e){this.watchListAction.emit(e)}close(){this.router.navigate([]),this.dialogRef.close()}static#t=this.\u0275fac=function(i){return new(i||s)(t.Y36(d.so),t.Y36(d.WI),t.Y36(N.H7),t.Y36(g.F0))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["app-movie-detail-modal"]],outputs:{watchListAction:"watchListAction"},standalone:!0,features:[t.jDz],decls:8,vars:2,consts:[["mat-dialog-title","",1,"bg-black","!p-0","!relative"],["mat-icon-button","",1,"!absolute","!right-0",3,"click"],[1,"!text-white"],[1,"bg-gray-600","!p-0"],[4,"ngIf","ngIfElse"],["noData",""],[1,"text-gray-600","body-font","flex","bg-gray-950","relative"],[1,"container","mx-auto","flex","px-2","py-5","items-center","justify-center","flex-col"],[1,"lg:w-2/3","w-full","animate-fade-in-down"],[1,"flex"],[1,"name"],["mat-icon-button","","aria-label","add or remove watchlist",1,"!text-white",3,"pTooltip","click"],[4,"ngIf"],[1,"mt-5","mb-5","md:leading-relaxed","leading-normal","text-white","tracking-tight","text-xl"],[1,"mb-5","flex","flex-col","gap-2"],[1,"flex","gap-x-4"],[1,"text-base","text-zinc-400","font-semibold","leading-8"],[1,"text-lg","text-white","flex"],[1,"text-yellow-400","text-3xl"],[1,"text-lg","text-white"],[1,"flex","gap-x-4","items-center","content-center"],["width","560","height","315","frameborder","0","webkitallowfullscreen","","mozallowfullscreen","","allowfullscreen","",3,"src",4,"ngIf"],[1,"ml-2","text-lg"],[1,"text-base"],["width","560","height","315","frameborder","0","webkitallowfullscreen","","mozallowfullscreen","","allowfullscreen","",3,"src"]],template:function(i,n){if(1&i&&(t.TgZ(0,"div",0)(1,"button",1),t.NdJ("click",function(){return n.close()}),t.TgZ(2,"mat-icon",2),t._uU(3,"close"),t.qZA()()(),t.TgZ(4,"mat-dialog-content",3),t.YNc(5,G,44,11,"ng-container",4),t.YNc(6,X,2,0,"ng-template",null,5,t.W1O),t.qZA()),2&i){const l=t.MAs(7);t.xp6(5),t.Q6J("ngIf",null==n.data?null:n.data.movie)("ngIfElse",l)}},dependencies:[u.ez,u.O5,d.Is,d.uh,d.xY,I.ot,I.RK,$.Ps,$.Hw,b.z,b.u],changeDetection:0})}return s})();function k(s,a){1&s&&t._UZ(0,"app-skeleton-loader")}function tt(s,a){if(1&s){const e=t.EpF();t.ynx(0),t._UZ(1,"app-movie-slider",3),t.TgZ(2,"app-movie-carousel",4),t.NdJ("sortByAction",function(n){t.CHM(e);const l=t.oxw(2);return t.KtG(l.requestSortBy(n))})("watchListAction",function(n){t.CHM(e);const l=t.oxw(2);return t.KtG(l.requestModifyWatchList(n))})("selected",function(n){t.CHM(e);const l=t.oxw(2);return t.KtG(l.selectMovie(n))}),t.qZA(),t.BQk()}if(2&s){const e=a.ngIf;t.xp6(1),t.Q6J("movies",e),t.xp6(1),t.Q6J("movies",e)}}function et(s,a){if(1&s&&(t.YNc(0,tt,3,2,"ng-container",2),t.ALo(1,"async")),2&s){const e=t.oxw();t.Q6J("ngIf",t.lcZ(1,1,e.movies$))}}let it=(()=>{class s{constructor(e,i,n,l){this.dialog=e,this.router=i,this.route=n,this.movieFacadeService=l,this.destroyRef=(0,t.f3M)(t.ktI),this.isLoading$=this.movieFacadeService.isLoading$,this.watchList$=this.movieFacadeService.watchList$.pipe((0,R.T)(1),(0,r.b)(c=>{this.movieFacadeService.setWatchListOnLocalStorage(c)}),function O(s,a,e){let i,n=!1;return s&&"object"==typeof s?({bufferSize:i=1/0,windowTime:a=1/0,refCount:n=!1,scheduler:e}=s):i=s??1/0,(0,Y.B)({connector:()=>new D(i,a,e),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:n})}(1)),this.movieDetails$=(0,x.a)([this.movieFacadeService.movieSelected$,this.watchList$]).pipe((0,p.U)(([c,h])=>{const m=h?.some(M=>M.title===c?.title);return c?{...c,isWatchList:!!m}:void 0})),this.movies$=(0,x.a)([this.movieFacadeService.movies$,this.watchList$]).pipe((0,p.U)(([c,h])=>c.map(m=>{const M=h.some(st=>st.title===m.title);return{...m,isWatchList:M}})))}ngOnInit(){this.initSubscriptions(),this.movieFacadeService.getMovies(),this.movieFacadeService.getWatchList()}initSubscriptions(){this.route.queryParams.pipe((0,L.q)(1),(0,A.h)(e=>e.title),(0,p.U)(e=>e.title),(0,r.b)(e=>{this.movieFacadeService.getMovie(e)}),(0,v.sL)(this.destroyRef)).subscribe(),(0,x.a)([this.route.queryParams,this.movieDetails$]).pipe((0,A.h)(([e,i])=>!!e.title&&!!i),(0,r.b)(([,e])=>{this.requestMovieDetailModalShow(e)}),(0,v.sL)(this.destroyRef)).subscribe()}requestSortBy(e){this.movieFacadeService.sortMovies(e)}requestModifyWatchList(e){this.movieFacadeService.modifyWatchList(e)}requestMovieDetailModalShow(e){this.dialogRef?this.dialogRef.componentInstance.data={movie:e}:(this.dialogRef=this.dialog.open(K,{data:{movie:e}}),this.dialogRef.componentInstance.watchListAction.pipe((0,r.b)(i=>this.requestModifyWatchList(i)),(0,v.sL)(this.destroyRef)).subscribe(),this.dialogRef.afterClosed().pipe((0,Q.x)(()=>this.dialogRef=void 0),(0,v.sL)(this.destroyRef)).subscribe())}selectMovie(e){this.navigateByQueryParams({title:e.title}),this.movieFacadeService.selectMovie(e)}navigateByQueryParams(e){this.router.navigate([],{queryParams:e,queryParamsHandling:"merge"})}static#t=this.\u0275fac=function(i){return new(i||s)(t.Y36(d.uw),t.Y36(g.F0),t.Y36(g.gz),t.Y36(_))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["app-list-v1"]],standalone:!0,features:[t._Bn([_,Z.$,w]),t.jDz],decls:4,vars:4,consts:[[4,"ngIf","ngIfElse"],["content",""],[4,"ngIf"],[3,"movies"],[3,"movies","sortByAction","watchListAction","selected"]],template:function(i,n){if(1&i&&(t.YNc(0,k,1,0,"app-skeleton-loader",0),t.ALo(1,"async"),t.YNc(2,et,2,3,"ng-template",null,1,t.W1O)),2&i){const l=t.MAs(3);t.Q6J("ngIf",t.lcZ(1,2,n.isLoading$))("ngIfElse",l)}},dependencies:[u.ez,u.O5,u.Ov,g.Bz,d.Is,q.A,z.t,J.Q],changeDetection:0})}return s})()}}]);